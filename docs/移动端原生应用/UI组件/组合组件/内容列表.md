# 内容列表

对于内容平台型的app,比如电商,视频站这类应用,内容列表是最基础的组合组件.

所谓内容列表就是将内容顺序排列出来的一种展示用组合组件.其中每项内容是一个单独的单元,他们合起来就共同构成了内容列表.


## 垂直滚动列表

垂直滚动列表是最常见的内容列表形式,列表中的元素安顺序从上到下的渲染展示,通常一个版面4~8个元素,这种形式兼顾信息密度和渲染效率.

### ListView

在`nativescript-vue`中原生的列表渲染方式是[list-view](https://docs.nativescript.org/ui/list-view),

其基本用法如下:

```vue
<ListView :items="listOfItems">
  <v-template #default="{ item }" >
    <Label :text="item.text" /> 
  </v-template>
</ListView>
```

用法上来说比较需要注意下与网页版的vue中`v-for`构造列表的区别.

在网页版的vue中我们通常都是用[v-for](https://blog.hszofficial.site/TutorialForFront-EndWeb/#/%E6%B5%8F%E8%A7%88%E5%99%A8%E7%8E%AF%E5%A2%83%E7%9A%84%E5%89%8D%E7%AB%AF%E5%BA%94%E7%94%A8/%E5%9F%BA%E4%BA%8Evue%E6%9E%84%E5%BB%BA%E5%89%8D%E7%AB%AF/vue%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/%E7%BB%84%E4%BB%B6%E6%A8%A1%E6%9D%BF?id=%e5%be%aa%e7%8e%af%e6%8c%87%e4%bb%a4)构造列表的,在nativescript-vue中我们当然也可以使用,但它适用于一步到位的渲染,它会将遍历对象中的所有内容都一次渲染到位.通常会用在那种内容没有很多的场景.我们的`helloworld`例子中`Details.vue`中就用它展示`details`字段中的内容.

而在[ListView](https://docs.nativescript.org/ui/list-view)只渲染可见项,当用户滑动时通过重用不再可见项的视图来渲染新项(这通常被称为视图回收).这种方式适用于列表项目较多的场景,这种情况下我们的屏幕就那么大,一次全部渲染会造成性能浪费甚至卡顿.我们的`helloworld`例子中`Home.vue`中每个电影都是用它渲染的.

`ListView`必须搭配`<v-template>`使用,在`<ListView>`标签中用`items`指定要遍历的列表,然后在`<v-template>`中指定`#default="{ item }"`让每个项目被赋值到`item`.

需要注意`ListView`通常都会要设置`rowHeight`,这样可以有更好的性能.

我们可以看到`ListView`中每个元素之间都会有个分割线,可以使用属性`separatorColor`设置分割线的颜色,也可以设置为`transparent`来取消分割线.

需要注意`<v-template>`的下一级必须只有**单独一个组件**,如果我们需要点击项目后有触发操作,可以在这个`<v-template>`下一级的组件上绑定`onTap`操作.

`ListView`的例子直接看[native-helloworld](https://github.com/hsz1273327/TutorialForFront-EndWeb/tree/native-helloworld)就好,这边就不再重复了

### CollectionView

基础的`ListView`组件过于简陋,并不太符合现在的常见的样式--通常为了信息有更高的密度我们会让列表以两排的形式展示,同时由于数据通常是从远端的服务器中获取得到的,为了减少数据传输量加强体验,我们还希望数据可以分页获取分页展示.也就是说相较于原生的list-view垂直滚动提供了如下特性:

1. 使用卡片展示信息,一行可以有多张卡片
2. 到达底部时可以触发事件拉取新数据

社区提供了插件[@nativescript-community/ui-collectionview](https://github.com/nativescript-community/ui-collectionview)可以提供垂直滚动列表.

使用它先安装,然后在入口文件中添加如下代码注册:

```ts
import CollectionView from '@nativescript-community/ui-collectionview/vue';
Vue.use(CollectionView);
```

之后我们需要准备好一个`ObservableArray`来包装物品列表,然后数据需要做些修改,要增加`index`字段用于标识.然后将其绑定到`CollectionView`的`items`属性,并将属性`itemIdGenerator`设为`index`就好,

> 例子:使用垂直滚动列表替代ListView

```vue
<template>
  <Page actionBarHidden="true">
    <StackLayout>
      <CollectionView
        :items="simplecardprops"
        itemIdGenerator="index"
        colWidth="50%"
        rowHeight="200"
      >
        <v-template>
          <SimpleCard v-bind="item.prop" />
        </v-template>
      </CollectionView>
    </StackLayout>
  </Page>
</template>
  

<script lang="ts">
import Vue from "vue";
import { ObservableArray } from "@nativescript/core";
import SimpleCard from "../components/SimpleCard.vue";

export default Vue.extend({
  components: {
    SimpleCard,
  },
  data: function () {
    return {
      simplecardprops: new ObservableArray([
        {
          index: 0,
          prop: {
            title: "test1",
            iconImgURL: "~/imgs/锦叶绿萝.png",
            mediaImgURL: "~/imgs/锦叶绿萝.png",
            description: "this is test's description1",
          },
        },
        {
          index: 1,
          prop: {
            title: "test2",
            iconImgURL: "~/imgs/建兰-玫瑰妖姬.jpg",
            mediaImgURL: "~/imgs/建兰-玫瑰妖姬.jpg",
            description: "this is test's description2",
          },
        },
        {
          index: 2,
          prop: {
            title: "test3",
            iconImgURL: "~/imgs/锦叶绿萝.png",
            mediaImgURL: "~/imgs/锦叶绿萝.png",
            description: "this is test's description3",
          },
        },
        {
          index: 3,
          prop: {
            title: "test4",
            iconImgURL: "~/imgs/建兰-玫瑰妖姬.jpg",
            mediaImgURL: "~/imgs/建兰-玫瑰妖姬.jpg",
            description: "this is test's description4",
          },
        },
      ]),
    };
  },
});
</script>
```

### 瀑布流

所谓瀑布流实际就是垂直滚动列表的一个样式上的变化,特点是只有一列,可以一直刷.
插件[@nativescript-community/ui-collectionview](https://github.com/nativescript-community/ui-collectionview)同样提供了瀑布流功能.要使用它除了要安装上面的`@nativescript-community/ui-collectionview`外还需要安装`@nativescript-community/ui-collectionview-waterfall`,然后在入口文件中除了要注册组件`CollectionView`外还要注册`waterfall`的插件

```ts
import CollectionView from '@nativescript-community/ui-collectionview/vue';
Vue.use(CollectionView);

import waterfallInstall from '@nativescript-community/ui-collectionview-waterfall';
waterfallInstall();
```

使用时设置属性`layoutStyle="waterfall"`即可

> 例子


### 下拉刷新

https://github.com/nativescript-community/ui-pulltorefresh

#### 水平滑动列表

水平滑动列表的形式可以参考各种首页的顶部的banner,可以手动左右滑动,也可以自动定时滑动,这个一般用在活动广告等地方.社区提供了插件[@nativescript-community/ui-pager](https://github.com/nativescript-community/ui-pager)用于支持这种样式.



